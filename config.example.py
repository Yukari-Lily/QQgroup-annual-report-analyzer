# -*- coding: utf-8 -*-
"""
QQ群年度报告分析器 - 配置文件

本文件包含命令行工具的所有可调参数，复制为 config.py 后修改使用
注意：后端服务配置请在 backend/.env 中设置
"""

# ============================================
# 基础配置
# ============================================

# 输入文件路径
# 使用 qq-chat-exporter 导出的 JSON 文件
# 示例：~/.qq-chat-exporter/exports/group_123456_20241212.json
INPUT_FILE = "chat.json"

# 输出编码
OUTPUT_ENCODING = "utf-8"

# 控制台输出宽度
CONSOLE_WIDTH = 60


# ============================================
# 词频统计参数
# ============================================

# 提取前 N 个高频词
# 推荐值：100-300，过大会包含太多低频词
TOP_N = 200

# 最小词频阈值
# 低于此频率的词会被过滤，推荐值：1-5
MIN_FREQ = 1

# 词长度限制
MIN_WORD_LEN = 1    # 最小词长（字符数）
MAX_WORD_LEN = 10   # 最大词长（字符数）


# ============================================
# 新词发现参数
# ============================================

# PMI（点互信息）阈值
# 衡量词组内部的紧密程度，越高表示越像一个词
# 推荐值：1.5-3.0，调高会减少新词但提高质量
PMI_THRESHOLD = 2.0

# 信息熵阈值
# 衡量词组边界的确定性，越高表示边界越清晰
# 推荐值：0.3-1.0，调高会减少新词但提高质量
ENTROPY_THRESHOLD = 0.5

# 新词最小频次
# 出现次数少于此值的词组不会被识别为新词
# 推荐值：10-30
NEW_WORD_MIN_FREQ = 20


# ============================================
# 词组合并参数
# ============================================

# 词组合并最小频次
# 相邻词组出现次数少于此值不会被合并
# 推荐值：20-50
MERGE_MIN_FREQ = 30

# 词组合并条件概率阈值
# P(w2|w1) 大于此值才会合并，表示 w1 后跟 w2 的概率
# 推荐值：0.2-0.5
MERGE_MIN_PROB = 0.3

# 词组合并最大长度
# 合并后的词组最大长度（字符数）
MERGE_MAX_LEN = 6


# ============================================
# 单字过滤参数
# ============================================

# 单字独立出现比例阈值
# 单字作为独立词出现的比例（独立出现次数/总出现次数）
# 低于此值的单字会被过滤（emoji 除外）
# 推荐值：0.01-0.05
SINGLE_MIN_SOLO_RATIO = 0.01

# 单字独立出现次数阈值
# 单字作为独立词出现的最少次数
# 低于此值的单字会被过滤（emoji 除外）
# 推荐值：3-10
SINGLE_MIN_SOLO_COUNT = 5


# ============================================
# 词汇配置
# ============================================

# 白名单：这些词会被强制保留，不受任何过滤规则影响
WHITELIST = set([
    # 示例：
    # '群友昵称',
    # '特殊词汇',
])

# 黑名单：这些词会被强制过滤掉（包含敏感词+常见虚词）
BLACKLIST = set([
    # 示例：
    # '广告词',
    # '敏感词',
    # 常见虚词：
    # '的', '了', '是', '在', '我', '有', '和', '就',
    # '不', '人', '都', '一', '一个', '上', '也', '很',
])


# ============================================
# 排行榜配置
# ============================================

# 各类排行榜显示的前 N 名
RANK_TOP_N = 10

# 热词贡献者显示的前 N 名
CONTRIBUTOR_TOP_N = 10

# 每个热词显示的示例消息数量
SAMPLE_COUNT = 10


# ============================================
# 时间分析配置
# ============================================

# 夜猫子时段（0-6点）
NIGHT_OWL_HOURS = range(0, 6)

# 早起鸟时段（6-9点）
EARLY_BIRD_HOURS = range(6, 9)


# ============================================
# 机器人过滤
# ============================================

# 是否过滤 QQ 机器人消息
# True：过滤掉机器人消息（推荐）
# False：保留所有消息
FILTER_BOT_MESSAGES = True


# ============================================
# AI 功能配置（可选）
# ============================================

# OpenAI 配置优先级说明：
# 1. 推荐方式：在 backend/.env 中配置（更安全，不会被 git 追踪）
# 2. 备用方式：在此文件中配置（不推荐，容易泄露密钥）
# 
# 如果两处都配置，backend/.env 的优先级更高
# main.py 会自动加载 backend/.env 中的环境变量

# OpenAI API Key
# 留空则不使用 AI 功能
# 获取地址：https://platform.openai.com/api-keys
# ⚠️ 建议在 backend/.env 中配置 OPENAI_API_KEY
OPENAI_API_KEY = ""

# OpenAI API 基础地址
# 官方地址：https://api.openai.com/v1
# 也可使用代理地址或其他兼容 OpenAI API 的服务
# ⚠️ 建议在 backend/.env 中配置 OPENAI_BASE_URL
OPENAI_BASE_URL = ""

# 使用的模型
# 推荐：gpt-4, gpt-4-turbo, gpt-3.5-turbo
# ⚠️ 建议在 backend/.env 中配置 OPENAI_MODEL
OPENAI_MODEL = ""

# AI 点评模式
# 'always'  - 总是生成 AI 点评
# 'never'   - 从不生成 AI 点评
# 'ask'     - 每次询问用户（默认）
AI_COMMENT_MODE = 'ask'


# ============================================
# 图片导出配置
# ============================================

# 是否启用图片导出功能
# True：启用图片导出（需要安装 Playwright）
# False：仅生成 HTML 报告
ENABLE_IMAGE_EXPORT = True

# 图片生成模式
# 'always'  - 总是生成图片
# 'never'   - 从不生成图片
# 'ask'     - 每次询问用户（默认）
IMAGE_GENERATION_MODE = 'ask'


# ============================================
# 高级配置（一般不需要修改）
# ============================================

# 如需添加自定义配置，请在下方添加
