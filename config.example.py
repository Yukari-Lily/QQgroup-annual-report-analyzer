# -*- coding: utf-8 -*-
"""
本文件包含命令行工具的所有可调参数，复制为 config.py 后修改使用
注意：后端服务配置请在 backend/.env 中设置
"""

# ============================================
# 基础配置
# ============================================

# 输入文件路径
# 使用 qq-chat-exporter 导出的 JSON 文件
# 示例：~/.qq-chat-exporter/exports/group_123456_20241212.json
INPUT_FILE = "chat.json"

# 输出编码
OUTPUT_ENCODING = "utf-8"

# 控制台输出宽度
CONSOLE_WIDTH = 60


# ============================================
# 词频统计参数
# ============================================

# 提取前 N 个高频词
# 推荐值：100-300，过大会包含太多低频词
TOP_N = 200

# 最小词频阈值
# 低于此频率的词会被过滤，推荐值：1-5
MIN_FREQ = 1

# 词长度限制
MIN_WORD_LEN = 1    # 最小词长（字符数）
MAX_WORD_LEN = 10   # 最大词长（字符数）


# ============================================
# 新词发现参数
# ============================================

# PMI（点互信息）阈值
# 衡量词组内部的紧密程度，越高表示越像一个词
# 推荐值：1.5-3.0，调高会减少新词但提高质量
PMI_THRESHOLD = 2.0

# 信息熵阈值
# 衡量词组边界的确定性，越高表示边界越清晰
# 推荐值：0.3-1.0，调高会减少新词但提高质量
ENTROPY_THRESHOLD = 0.5

# 新词最小频次
# 出现次数少于此值的词组不会被识别为新词
# 推荐值：10-30
NEW_WORD_MIN_FREQ = 20


# ============================================
# 词组合并参数
# ============================================

# 词组合并最小频次
# 相邻词组出现次数少于此值不会被合并
# 推荐值：20-50
MERGE_MIN_FREQ = 30

# 词组合并条件概率阈值
# P(w2|w1) 大于此值才会合并，表示 w1 后跟 w2 的概率
# 推荐值：0.2-0.5
MERGE_MIN_PROB = 0.3

# 词组合并最大长度
# 合并后的词组最大长度（字符数）
MERGE_MAX_LEN = 6


# ============================================
# 单字过滤参数
# ============================================

# 单字独立出现比例阈值
# 单字作为独立词出现的比例（独立出现次数/总出现次数）
# 低于此值的单字会被过滤（emoji 除外）
# 推荐值：0.01-0.05
SINGLE_MIN_SOLO_RATIO = 0.01

# 单字独立出现次数阈值
# 单字作为独立词出现的最少次数
# 低于此值的单字会被过滤（emoji 除外）
# 推荐值：3-10
SINGLE_MIN_SOLO_COUNT = 5


# ============================================
# 词汇配置
# ============================================

# 白名单：这些词会被强制保留，不受任何过滤规则影响
WHITELIST = set([
])

# 黑名单：这些词会被强制过滤掉（包含敏感词+常见虚词）
BLACKLIST = set([
    # 示例：
    # '广告词',
    # '敏感词',
    # 常见虚词：
    # '的', '了', '是', '在', '我', '有', '和', '就',
    # '不', '人', '都', '一', '一个', '上', '也', '很',
])


# ============================================
# 排行榜配置
# ============================================

# 各类排行榜显示的前 N 名
RANK_TOP_N = 10

# 热词贡献者显示的前 N 名
CONTRIBUTOR_TOP_N = 10

# 每个热词显示的示例消息数量
SAMPLE_COUNT = 10


# ============================================
# 时间分析配置
# ============================================

# 消息时间范围过滤
# 格式：'YYYY-MM-DD' 或 None（不限制）
# 示例：MESSAGE_START_DATE = '2024-01-01'
#      MESSAGE_END_DATE = '2024-12-31'
# 留空或设为 None 表示不限制该端
MESSAGE_START_DATE = None  # 起始日期（包含）
MESSAGE_END_DATE = None    # 结束日期（包含）

# 夜猫子时段（0-6点）
NIGHT_OWL_HOURS = range(0, 6)

# 早起鸟时段（6-9点）
EARLY_BIRD_HOURS = range(6, 9)


# ============================================
# 机器人过滤
# ============================================

# 是否过滤 QQ 机器人消息
# True：过滤掉机器人消息（推荐）
# False：保留所有消息
FILTER_BOT_MESSAGES = True


# ============================================
# AI 功能配置（可选）
# ============================================

# OpenAI 配置优先级说明：
# 1. 推荐方式：在 backend/.env 中配置（更安全，不会被 git 追踪）
# 2. 备用方式：在此文件中配置（不推荐，容易泄露密钥）
# 
# 如果两处都配置，backend/.env 的优先级更高

# OpenAI API Key
# 留空则不使用 AI 功能
OPENAI_API_KEY = ""

# OpenAI API 基础地址
OPENAI_BASE_URL = ""

# 使用的模型
OPENAI_MODEL = ""

# AI 点评模式
# 'always'  - 总是生成 AI 点评
# 'never'   - 从不生成 AI 点评
# 'ask'     - 每次询问用户（默认）
AI_COMMENT_MODE = 'ask'


# ============================================
# 图片导出配置
# ============================================

# 是否启用图片导出功能
# True：启用图片导出（需要安装 Playwright）
# False：仅生成 HTML 报告
ENABLE_IMAGE_EXPORT = True

# 图片生成模式
# 'always'  - 总是生成图片
# 'never'   - 从不生成图片
# 'ask'     - 每次询问用户（默认）
IMAGE_GENERATION_MODE = 'ask'


# ============================================
# 日志配置
# ============================================

# 日志输出模式
# 'simple'  - 简化模式：只在终端显示关键进度信息，详细信息写入日志文件
# 'verbose' - 详细模式：在终端显示更多信息（默认）
# 'debug'   - 调试模式：显示所有调试信息
LOG_MODE = 'simple'

# 日志文件目录
LOG_DIR = 'runtime_outputs/logs'


# 日志文件级别（文件中始终记录详细信息）
LOG_FILE_LEVEL = 'DEBUG'

# 单个日志文件最大字节数，超过则轮转，单位字节（默认 10MB）
LOG_MAX_BYTES = 10 * 1024 * 1024

# 轮转日志文件保留数量（默认 5 个）
LOG_BACKUP_COUNT = 5

# 是否运行在 Docker 模式（启用后禁用文件日志）
DOCKER_MODE = False


# ============================================
# 其他配置
# ============================================

# 备用锐评列表，供AI锐评生成失败时使用
FALLBACK_COMMENTS = [
    "群友的快乐，简单又纯粹",
    "这个词承载了太多故事",
    "高频出现，必有原因",
    "群聊精华，浓缩于此",
    "每一次使用都是一次认同",
    "年度最佳复读内容",
    "群友的精神图腾",
    "打工人的快乐源泉",
    "网络冲浪必备单品",
    "社交货币硬通货",
    "群聊氛围担当",
    "情绪价值拉满",
    "网感拉满的证明",
    "互联网嘴替本替",
    "电子榨菜实锤了",
    "赛博朋克新语言",
    "数字原住民的暗号",
    "网络社交学必修课",
    "当代年轻人的精神寄托",
    "互联网黑话入门",
    "群聊文化的活化石",
    "网络梗王预定",
    "流量密码找到了",
    "整活儿必备道具",
    "网络冲浪高级玩家",
    "赛博世界的通行证",
    "互联网考古新发现",
    "群友智慧的结晶",
    "网络文学新高度",
    "电子包浆已形成",
    "互联网老登实锤",
    "赛博空间的印记",
    "数字时代的符号"
]
